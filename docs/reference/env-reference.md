# Справочник по переменным окружения (.env)

## Обзор

Проект использует `django-environ` для управления настройками через переменные окружения. Все настройки хранятся в файле
`.env` в корне проекта.

## Создание .env файла

Создайте файл `.env` в корне проекта на основе `.env.example` (если есть) или используйте пример ниже.

## Обязательные переменные

### SECRET_KEY

**Описание:** Секретный ключ Django для криптографической подписи.

**Тип:** Строка

**Пример:**

```env
SECRET_KEY=django-insecure-your-secret-key-here-change-in-production
```

**Как получить:**

```python
from django.core.management.utils import get_random_secret_key
print(get_random_secret_key())
```

**Важно:** Никогда не коммитьте реальный SECRET_KEY в репозиторий!

---

### DEBUG

**Описание:** Режим отладки. Включает детальные страницы ошибок.

**Тип:** Boolean (True/False)

**Пример:**

```env
DEBUG=True
```

**Рекомендации:**

- `True` — для разработки
- `False` — для продакшена

**Важно:** В продакшене всегда должно быть `False`!

---

### DATABASE_NAME

**Описание:** Имя файла базы данных SQLite.

**Тип:** Строка

**Пример:**

```env
DATABASE_NAME=db.sqlite3
```

**По умолчанию:** `db.sqlite3`

---

## Безопасность

### IS_DDT_ACTIVE

**Описание:** Активация Django Debug Toolbar.

**Тип:** Boolean (True/False)

**Пример:**

```env
IS_DDT_ACTIVE=True
```

**Рекомендации:**

- `True` — для разработки (показывает SQL запросы, время выполнения)
- `False` — для продакшена

**Использование:** Включает панель отладки в правой части страницы.

---

### IP_INFO_KEY

**Описание:** API ключ для сервиса определения информации по IP.

**Тип:** Строка (опционально)

**Пример:**

```env
IP_INFO_KEY=your-ip-info-api-key
```

**Использование:** Для определения страны и другой информации по IP-адресу.

---

## Геокодирование

### GEO_CODER_KEY

**Описание:** API ключ для сервиса геокодирования.

**Тип:** Строка (опционально)

**Пример:**

```env
GEO_CODER_KEY=your-geocoder-api-key
```

**Использование:** Для определения координат по адресу.

---

### GEO_CODER_LIMIT

**Описание:** Лимит запросов к API геокодера.

**Тип:** Целое число

**Пример:**

```env
GEO_CODER_LIMIT=1000
```

**По умолчанию:** `1000`

**Использование:** Ограничивает количество запросов к внешнему API.

---

## Telegram бот

### TELEGRAM_BOT_TOKEN

**Описание:** Токен Telegram бота.

**Тип:** Строка (опционально)

**Пример:**

```env
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
```

**Как получить:**

1. Создайте бота через [@BotFather](https://t.me/BotFather)
2. Получите токен
3. Добавьте в `.env`

---

## Логирование

### LOG_DIR

**Описание:** Директория для хранения логов.

**Тип:** Строка

**Пример:**

```env
LOG_DIR=logs
```

**По умолчанию:** `logs`

**Структура:**

```
logs/
├── logs.log              # Основные логи
├── errors.log            # Только ошибки
├── django/               # Логи Django
├── security/             # Логи безопасности
├── database/              # Логи БД
├── server/                # Логи сервера
└── third-party/           # Логи сторонних библиотек
```

---

### LOG_MAIN_FILE_SIZE

**Описание:** Максимальный размер основного лог-файла в МБ.

**Тип:** Целое число

**Пример:**

```env
LOG_MAIN_FILE_SIZE=6
```

**По умолчанию:** `6` (МБ)

**Использование:** После достижения размера файл ротируется.

---

### LOG_FILE_SIZE

**Описание:** Максимальный размер лог-файлов в МБ.

**Тип:** Целое число

**Пример:**

```env
LOG_FILE_SIZE=2
```

**По умолчанию:** `2` (МБ)

---

### LOG_BACKUP_COUNT

**Описание:** Количество резервных копий лог-файлов.

**Тип:** Целое число

**Пример:**

```env
LOG_BACKUP_COUNT=10
```

**По умолчанию:** `10`

**Использование:** Хранит 10 резервных копий каждого лог-файла.

---

### ROOT_LOG_LEVEL

**Описание:** Уровень логирования для корневого логгера.

**Тип:** Строка (DEBUG/INFO/WARNING/ERROR/CRITICAL)

**Пример:**

```env
ROOT_LOG_LEVEL=INFO
```

**По умолчанию:** `INFO`

**Варианты:**

- `DEBUG` — детальная информация
- `INFO` — общая информация
- `WARNING` — предупреждения
- `ERROR` — ошибки
- `CRITICAL` — критические ошибки

---

### THIRD_LOG_LEVEL

**Описание:** Уровень логирования для сторонних библиотек.

**Тип:** Строка (DEBUG/INFO/WARNING/ERROR/CRITICAL)

**Пример:**

```env
THIRD_LOG_LEVEL=INFO
```

**По умолчанию:** `INFO`

---

## Статические файлы

### STATIC_URL

**Описание:** URL префикс для статических файлов.

**Тип:** Строка

**Пример:**

```env
STATIC_URL=static/
```

**По умолчанию:** `static/`

**Использование:** URL для доступа к статическим файлам (CSS, JS, изображения).

---

### MEDIA_URL

**Описание:** URL префикс для медиа файлов.

**Тип:** Строка

**Пример:**

```env
MEDIA_URL=media/
```

**По умолчанию:** `media/`

**Использование:** URL для доступа к загруженным файлам (изображения товаров, аватары).

---

### IS_COMPRESS_ENABLED

**Описание:** Включение сжатия статических файлов через django-compressor.

**Тип:** Boolean (True/False)

**Пример:**

```env
IS_COMPRESS_ENABLED=True
```

**По умолчанию:** `True`

**Использование:** Сжимает CSS и JS файлы для уменьшения размера.

---

## Тестирование

### DATABASE_TEST_NAME

**Описание:** Имя тестовой базы данных.

**Тип:** Строка

**Пример:**

```env
DATABASE_TEST_NAME=test_db.sqlite3
```

**По умолчанию:** `test_db.sqlite3`

**Использование:** Отдельная БД для тестов.

---

### TEST_MAX_RESPONSE_TIME

**Описание:** Максимальное время ответа для тестов (в секундах).

**Тип:** Число с плавающей точкой

**Пример:**

```env
TEST_MAX_RESPONSE_TIME=1.0
```

**По умолчанию:** `1.0`

---

### TEST_FAKER_SEED

**Описание:** Seed для генератора случайных данных Faker.

**Тип:** Целое число

**Пример:**

```env
TEST_FAKER_SEED=42
```

**По умолчанию:** `-1` (случайный seed)

**Использование:** Фиксированный seed для воспроизводимых тестов.

---

### TEST_MEDIA_ROOT

**Описание:** Директория для тестовых медиа файлов.

**Тип:** Строка

**Пример:**

```env
TEST_MEDIA_ROOT=test_media
```

**По умолчанию:** `test_media`

**Использование:** Отдельная директория для медиа файлов в тестах.

---

## Временные события

### IS_HALLOWEEN

**Описание:** Активация темы Хэллоуина.

**Тип:** Boolean (True/False)

**Пример:**

```env
IS_HALLOWEEN=True
```

**По умолчанию:** `False`

**Использование:** Включает специальную тему для Хэллоуина.

---

### IS_NEW_YEAR

**Описание:** Активация новогодней темы.

**Тип:** Boolean (True/False)

**Пример:**

```env
IS_NEW_YEAR=True
```

**По умолчанию:** `False`

**Использование:** Включает специальную тему для Нового года.

---

## Регистрация

### MIN_AGE_REGISTRATION

**Описание:** Минимальный возраст для регистрации.

**Тип:** Целое число

**Пример:**

```env
MIN_AGE_REGISTRATION=14
```

**По умолчанию:** `14`

**Использование:** Валидация возраста при регистрации.

---

### MAX_AGE_REGISTRATION

**Описание:** Максимальный возраст для регистрации.

**Тип:** Целое число

**Пример:**

```env
MAX_AGE_REGISTRATION=100
```

**По умолчанию:** `100`

**Использование:** Валидация возраста при регистрации.

## Пример полного .env файла

```env
# ============================================================================
# БАЗОВЫЕ НАСТРОЙКИ
# ============================================================================
SECRET_KEY=django-insecure-change-this-in-production
DEBUG=True
DATABASE_NAME=db.sqlite3
DATABASE_TEST_NAME=test_db.sqlite3

# ============================================================================
# БЕЗОПАСНОСТЬ
# ============================================================================
IS_DDT_ACTIVE=True
IP_INFO_KEY=

# ============================================================================
# ГЕОКОДИРОВАНИЕ
# ============================================================================
GEO_CODER_KEY=
GEO_CODER_LIMIT=1000

# ============================================================================
# TELEGRAM БОТ
# ============================================================================
TELEGRAM_BOT_TOKEN=

# ============================================================================
# ЛОГИРОВАНИЕ
# ============================================================================
LOG_DIR=logs
LOG_MAIN_FILE_SIZE=6
LOG_FILE_SIZE=2
LOG_BACKUP_COUNT=10
ROOT_LOG_LEVEL=INFO
THIRD_LOG_LEVEL=INFO

# ============================================================================
# СТАТИЧЕСКИЕ ФАЙЛЫ
# ============================================================================
STATIC_URL=static/
MEDIA_URL=media/
IS_COMPRESS_ENABLED=True

# ============================================================================
# ТЕСТИРОВАНИЕ
# ============================================================================
TEST_MAX_RESPONSE_TIME=1.0
TEST_FAKER_SEED=-1
TEST_MEDIA_ROOT=test_media

# ============================================================================
# ВРЕМЕННЫЕ СОБЫТИЯ
# ============================================================================
IS_HALLOWEEN=False
IS_NEW_YEAR=False

# ============================================================================
# РЕГИСТРАЦИЯ
# ============================================================================
MIN_AGE_REGISTRATION=14
MAX_AGE_REGISTRATION=100
```

## Безопасность

### Что НЕ коммитить

Никогда не коммитьте в репозиторий:

- Реальный `SECRET_KEY`
- API ключи (`GEO_CODER_KEY`, `IP_INFO_KEY`, `TELEGRAM_BOT_TOKEN`)
- Файл `.env` с реальными значениями

### Что коммитить

Можно коммитить:

- `.env.example` — пример с пустыми значениями
- Документацию

## Проверка переменных

Проверить, что все переменные загружены:

```python
# В Django shell
from django.conf import settings
print(settings.SECRET_KEY)
print(settings.DEBUG)
```

## Решение проблем

### Переменная не загружается

1. Проверьте, что файл `.env` находится в корне проекта
2. Проверьте синтаксис (нет лишних пробелов, кавычек)
3. Перезапустите сервер разработки

### Ошибка при чтении .env

Убедитесь, что используется правильный формат:

```env
KEY=value
# Не используйте кавычки
KEY="value"  # Неправильно
```

